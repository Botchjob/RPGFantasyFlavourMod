<?xml version="1.0" encoding="utf-8"?>

<!-- This Patch adds the key token OpportunitySite into all the Witcher quest def names -->
<!-- this is necessary because RimQuest is hardcoded to look for that token to determine valid quests. -->
<!-- See https://discord.com/channels/480546382130708490/1059938161582686358/1060174891330064464 for details -->
<Patch>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Nekker_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Nekker_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Ghoul_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Ghoul_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Ekimmara_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Ekimmara_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Djinn_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Djinn_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Basilisk_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Basilisk_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Fleder_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Fleder_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Hym_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Hym_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Kikimore_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Kikimore_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Werewolf_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Werewolf_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Wraith_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Wraith_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Fogler_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Fogler_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Cyclops_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Cyclops_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Chort_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Chort_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Bearofleet_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Bearofleet_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Fiend_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Fiend_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Golem_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Golem_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Leshy_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Leshy_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationReplace">
        <xpath>Defs/QuestScriptDef[defName="WMH_Wyvern_MonsterEncounterQuest"]/defName</xpath>
        <value>
            <defName>WMH_OpportunitySite_Wyvern_MonsterEncounterQuest</defName>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/RimQuest.QuestGiverDef[defName="RQ_MedievalQuestGiver"]/questsScripts</xpath>
        <value>
            <WMH_OpportunitySite_Nekker_MonsterEncounterQuest>3</WMH_OpportunitySite_Nekker_MonsterEncounterQuest>
            <WMH_OpportunitySite_Ghoul_MonsterEncounterQuest>3</WMH_OpportunitySite_Ghoul_MonsterEncounterQuest>
            <WMH_OpportunitySite_Ekimmara_MonsterEncounterQuest>2</WMH_OpportunitySite_Ekimmara_MonsterEncounterQuest>
            <WMH_OpportunitySite_Djinn_MonsterEncounterQuest>2</WMH_OpportunitySite_Djinn_MonsterEncounterQuest>
            <WMH_OpportunitySite_Basilisk_MonsterEncounterQuest>2</WMH_OpportunitySite_Basilisk_MonsterEncounterQuest>
            <WMH_OpportunitySite_Fleder_MonsterEncounterQuest>2</WMH_OpportunitySite_Fleder_MonsterEncounterQuest>
            <WMH_OpportunitySite_Hym_MonsterEncounterQuest>2</WMH_OpportunitySite_Hym_MonsterEncounterQuest>
            <WMH_OpportunitySite_Kikimore_MonsterEncounterQuest>2</WMH_OpportunitySite_Kikimore_MonsterEncounterQuest>
            <WMH_OpportunitySite_Werewolf_MonsterEncounterQuest>2</WMH_OpportunitySite_Werewolf_MonsterEncounterQuest>
            <WMH_OpportunitySite_Wraith_MonsterEncounterQuest>2</WMH_OpportunitySite_Wraith_MonsterEncounterQuest>
            <WMH_OpportunitySite_Fogler_MonsterEncounterQuest>2</WMH_OpportunitySite_Fogler_MonsterEncounterQuest>
            <WMH_OpportunitySite_Cyclops_MonsterEncounterQuest>1</WMH_OpportunitySite_Cyclops_MonsterEncounterQuest>
            <WMH_OpportunitySite_Chort_MonsterEncounterQuest>1</WMH_OpportunitySite_Chort_MonsterEncounterQuest>
            <WMH_OpportunitySite_Bearofleet_MonsterEncounterQuest>1</WMH_OpportunitySite_Bearofleet_MonsterEncounterQuest>
            <WMH_OpportunitySite_Fiend_MonsterEncounterQuest>1</WMH_OpportunitySite_Fiend_MonsterEncounterQuest>
            <WMH_OpportunitySite_Golem_MonsterEncounterQuest>1</WMH_OpportunitySite_Golem_MonsterEncounterQuest>
            <WMH_OpportunitySite_Leshy_MonsterEncounterQuest>1</WMH_OpportunitySite_Leshy_MonsterEncounterQuest>
            <WMH_OpportunitySite_Wyvern_MonsterEncounterQuest>1</WMH_OpportunitySite_Wyvern_MonsterEncounterQuest>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/RimQuest.QuestGiverDef[defName="RQ_TribalQuestGiver"]/questsScripts</xpath>
        <value>
            <WMH_OpportunitySite_Nekker_MonsterEncounterQuest>3</WMH_OpportunitySite_Nekker_MonsterEncounterQuest>
            <WMH_OpportunitySite_Ghoul_MonsterEncounterQuest>3</WMH_OpportunitySite_Ghoul_MonsterEncounterQuest>
            <WMH_OpportunitySite_Ekimmara_MonsterEncounterQuest>2</WMH_OpportunitySite_Ekimmara_MonsterEncounterQuest>
            <WMH_OpportunitySite_Djinn_MonsterEncounterQuest>2</WMH_OpportunitySite_Djinn_MonsterEncounterQuest>
            <WMH_OpportunitySite_Basilisk_MonsterEncounterQuest>2</WMH_OpportunitySite_Basilisk_MonsterEncounterQuest>
            <WMH_OpportunitySite_Fleder_MonsterEncounterQuest>2</WMH_OpportunitySite_Fleder_MonsterEncounterQuest>
            <WMH_OpportunitySite_Hym_MonsterEncounterQuest>2</WMH_OpportunitySite_Hym_MonsterEncounterQuest>
            <WMH_OpportunitySite_Kikimore_MonsterEncounterQuest>2</WMH_OpportunitySite_Kikimore_MonsterEncounterQuest>
            <WMH_OpportunitySite_Werewolf_MonsterEncounterQuest>2</WMH_OpportunitySite_Werewolf_MonsterEncounterQuest>
            <WMH_OpportunitySite_Wraith_MonsterEncounterQuest>2</WMH_OpportunitySite_Wraith_MonsterEncounterQuest>
            <WMH_OpportunitySite_Fogler_MonsterEncounterQuest>2</WMH_OpportunitySite_Fogler_MonsterEncounterQuest>
            <WMH_OpportunitySite_Cyclops_MonsterEncounterQuest>1</WMH_OpportunitySite_Cyclops_MonsterEncounterQuest>
            <WMH_OpportunitySite_Chort_MonsterEncounterQuest>1</WMH_OpportunitySite_Chort_MonsterEncounterQuest>
            <WMH_OpportunitySite_Bearofleet_MonsterEncounterQuest>1</WMH_OpportunitySite_Bearofleet_MonsterEncounterQuest>
            <WMH_OpportunitySite_Fiend_MonsterEncounterQuest>1</WMH_OpportunitySite_Fiend_MonsterEncounterQuest>
            <WMH_OpportunitySite_Golem_MonsterEncounterQuest>1</WMH_OpportunitySite_Golem_MonsterEncounterQuest>
            <WMH_OpportunitySite_Leshy_MonsterEncounterQuest>1</WMH_OpportunitySite_Leshy_MonsterEncounterQuest>
            <WMH_OpportunitySite_Wyvern_MonsterEncounterQuest>1</WMH_OpportunitySite_Wyvern_MonsterEncounterQuest>
        </value>
    </Operation>

</Patch>
